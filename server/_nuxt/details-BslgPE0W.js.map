{"version":3,"file":"details-BslgPE0W.js","sources":["../../../../src/components/user/details/detailsItem.vue","../../../../src/components/user/details/index.vue"],"sourcesContent":["<template>\r\n    <div class=\"details-item\">\r\n        <div class=\"li\" v-for=\"(item, idx) in list.grouped\" :key=\"idx\">\r\n            <div class=\"lil\">\r\n                <div class=\"lil-label\" v-for=\"(val, key) in list.labelArr\" :key=\"key\">\r\n                    {{ langCondition(val) ? t(val) : val }}\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"lir\">\r\n                <publicQuestionTips :txt=\"i\" appendClass=\".user-details\" v-for=\"(i, k) in item\" class=\"lir-tips\">\r\n                </publicQuestionTips>\r\n            </div>\r\n        </div>\r\n        <slot></slot>\r\n    </div>\r\n</template>\r\n<script setup>\r\nconst props = defineProps({\r\n    list: {\r\n        type: Object,\r\n        default: {}\r\n    }\r\n})\r\nconst { t } = useI18n()\r\n// 判斷文案是否需要轉多語言(兼容$0.00情況)\r\nconst langCondition = (word) => typeof word === \"string\" && word.includes(\".\") && isNaN(Number(word.split('.')[1]))\r\n</script>\r\n<style scoped lang='scss'>\r\n.details-item {\r\n    .li {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        width: 100%;\r\n\r\n        &:not(:first-child) {\r\n            padding-top: 4.8vw;\r\n            border-top: 1px solid #515151;\r\n        }\r\n\r\n        &:first-child {\r\n            padding-top: 2.1333vw;\r\n        }\r\n    }\r\n\r\n    .lil {}\r\n\r\n    .lil-label {\r\n        min-height: 4.8vw;\r\n        line-height: 1;\r\n        font-size: 3.2vw;\r\n        color: #979797;\r\n        margin-bottom: 2.6667vw;\r\n    }\r\n\r\n    .lir {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: flex-end;\r\n\r\n        :deep(.label) {\r\n            margin-bottom: 2.6667vw;\r\n        }\r\n    }\r\n}\r\n</style>","<template>\r\n        <div class=\"user-details\">\r\n                <div class=\"user-details_header\">\r\n                        <nuxt-link-locale class=\"back-m\" to=\"/user\">\r\n\r\n                        </nuxt-link-locale>\r\n                        <span class=\"title-inner\">{{ t('Battle.title') }}</span>\r\n                </div>\r\n                <div class=\"badge\">{{ t(\"common.step\", { num: detailInfo.phaseIndex }) }}</div>\r\n                <div class=\"user-details_inner\">\r\n                        <div class=\"boxInner\">\r\n                                <div class=\"accountBox\">\r\n                                        <clientOnly>\r\n                                                <div class=\"textLine\">\r\n                                                        <publicQuestionTips\r\n                                                                :txt=\"{ faq: ['User.txt22'], label: t('common.fund58') }\"\r\n                                                                appendClass=\".user-details\">\r\n                                                        </publicQuestionTips>\r\n                                                        <span class=\"value\">\r\n                                                                {{\r\n                                                                        formatNumberWithCurrency(challengeDetailHooks.totalAccountBalance)\r\n                                                                }}\r\n                                                        </span>\r\n                                                </div>\r\n                                                <div class=\"textLine\">\r\n                                                        <publicQuestionTips\r\n                                                                :txt=\"{ faq: ['User.tips9'], label: t('Battle.txt1') }\"\r\n                                                                appendClass=\".user-details\">\r\n                                                        </publicQuestionTips>\r\n                                                        <span class=\"value\">{{\r\n                                                                detailInfo.eliminatedAccountNetWrth\r\n                                                                        ? formatNumberWithCurrency(\r\n                                                                                detailInfo.eliminatedAccountNetWrth,\r\n                                                                        )\r\n                                                                        : formatNumberWithCurrency(\r\n                                                                                detailInfo.accountNetWrth,\r\n                                                                        )\r\n                                                        }}</span>\r\n                                                </div>\r\n                                                <div class=\"textLine\">\r\n                                                        <publicQuestionTips\r\n                                                                :txt=\"{ faq: ['User.tips10'], label: t('Battle.txt2') }\"\r\n                                                                appendClass=\".user-details\">\r\n                                                        </publicQuestionTips>\r\n                                                        <span class=\"value\">{{\r\n                                                                formatNumberWithCurrency(\r\n                                                                        detailInfo.dailySettlementNetWrth,\r\n                                                                )\r\n                                                        }}</span>\r\n                                                </div>\r\n                                                <div class=\"textLine\">\r\n                                                        <publicQuestionTips\r\n                                                                :txt=\"{ faq: ['User.tips11'], label: t('Battle.li.li2') }\"\r\n                                                                appendClass=\".user-details\">\r\n                                                        </publicQuestionTips>\r\n                                                        <span class=\"value\">\r\n                                                                {{\r\n                                                                        formatNumberWithCurrency(\r\n                                                                                detailInfo.maxDailyDrawdown,\r\n                                                                        )\r\n                                                                }}\r\n                                                                ({{\r\n                                                                        t('Battle.tips3', {\r\n                                                                                num: formatNumberWithCurrency(\r\n                                                                                        detailInfo.minAccountTdnw,\r\n                                                                                ),\r\n                                                                        })\r\n                                                                }})\r\n                                                        </span>\r\n                                                </div>\r\n                                                <div class=\"textLine\">\r\n                                                        <publicQuestionTips\r\n                                                                :txt=\"{ faq: ['User.tips12'], label: t('Battle.txt3') }\"\r\n                                                                appendClass=\".user-details\">\r\n                                                        </publicQuestionTips>\r\n                                                        <span class=\"value\">{{\r\n                                                                formatNumberWithCurrency(\r\n                                                                        detailInfo.maxTotalDrawdown,\r\n                                                                )\r\n                                                        }}\r\n                                                                ({{\r\n                                                                        t('Battle.tips3', {\r\n                                                                                num: formatNumberWithCurrency(\r\n                                                                                        detailInfo.minAccountTdnw,\r\n                                                                                ),\r\n                                                                        })\r\n                                                                }})\r\n                                                        </span>\r\n                                                </div>\r\n                                        </clientOnly>\r\n                                </div>\r\n                                <div class=\"tradeBox-gap\"></div>\r\n                                <div class=\"tradeBox\">\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">{{ t('Battle.txt4') }}</span>\r\n                                                <publicQuestionTips\r\n                                                        :txt=\"{ faq: ['User.tips18'], label: t('Battle.txt5') }\"\r\n                                                        appendClass=\".user-details\" :alignR=\"true\" :heightAuto=\"true\">\r\n                                                </publicQuestionTips>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">TARGET</span>\r\n                                                <span class=\"labell\">{{\r\n                                                        detailInfo.phaseIndex == 3 && detailInfo.status == 0 ? \"--\"\r\n                                                                : t('User.txt40', { day: detailInfo.minTradingDay }) }}</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">RESULT</span>\r\n                                                <span class=\"labell\">{{ t('User.txt40', {\r\n                                                        day:\r\n                                                                detailInfo.currentTradingDay\r\n                                                }) }}</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">SUMMARY</span>\r\n                                                <span class=\"labell\"\r\n                                                        v-if=\"detailInfo.phaseIndex == 3 && detailInfo.status == 0\">{{\r\n                                                                t('Battle.tips5') }}</span>\r\n                                                <span class=\"labell\" v-else>{{ detailInfo.tradingDayResult === 0 ?\r\n                                                        t('Battle.tips5') : t('User.list.stu1') }}</span>\r\n                                        </div>\r\n                                </div>\r\n                                <div class=\"tradeBox\">\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">{{ t('Battle.txt4') }}</span>\r\n                                                <publicQuestionTips\r\n                                                        :txt=\"{ faq: ['TradingRules.basicRules.list.profit.cxt'], label: t('Battle.li.li4') }\"\r\n                                                        appendClass=\".user-details\" :alignR=\"true\" :heightAuto=\"true\">\r\n                                                </publicQuestionTips>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">TARGET</span>\r\n                                                <span class=\"labell\">{{\r\n                                                        detailInfo.phaseIndex == 3 && detailInfo.status == 0 ? \"--\"\r\n                                                                : formatNumberWithCurrency(\r\n                                                                        detailInfo.targetProfit,\r\n                                                                ) }}</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">RESULT</span>\r\n                                                <span class=\"labell\">{{ formatNumberWithCurrency(\r\n                                                        detailInfo.currentProfit) }}</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">SUMMARY</span>\r\n                                                <span class=\"labell\"\r\n                                                        v-if=\"detailInfo.phaseIndex == 3 && detailInfo.status == 0\">{{\r\n                                                                formatNumberWithCurrency(\r\n                                                                        detailInfo.currentProfit,\r\n                                                                ) > 0\r\n                                                                        ? t('Battle.tips5')\r\n                                                                        : t('User.list.stu1')\r\n                                                        }}</span>\r\n                                                <span class=\"labell\" v-else>{{ detailInfo.targetProfitResult === 0\r\n                                                        ? t('Battle.tips5')\r\n                                                        : t('User.list.stu1') }}</span>\r\n                                        </div>\r\n                                </div>\r\n                                <div class=\"tradeBox\">\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">{{ t('Battle.txt4') }}</span>\r\n                                                <span class=\"labell\">{{ t('Battle.txt6') }}</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">TARGET</span>\r\n                                                <span class=\"labell\">--</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">RESULT</span>\r\n                                                <span class=\"labell\">--</span>\r\n                                        </div>\r\n                                        <div class=\"textLine between\">\r\n                                                <span class=\"label\">SUMMARY</span>\r\n                                                <span class=\"labell\">{{ detailInfo.positionResult === 0\r\n                                                        ? t('Battle.tips5')\r\n                                                        : t('User.list.stu1') }}</span>\r\n                                        </div>\r\n                                </div>\r\n                                <div class=\"tradeBox-gap\"></div>\r\n                                <!-- 挑戰狀態 -->\r\n                                <challengeCollapseItem :title=\"collapseTitle\" :collapseTitleColor=\"collapseTitleColor\"\r\n                                        :isColor=\"true\">\r\n                                        <div class=\"challengeBox\"\r\n                                                v-if=\"detailInfo.status == 2 || detailInfo.status == 3\">\r\n                                                <div class=\"textWrap\">\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.label1')\r\n                                                                }}</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.dailyDrawdownStatusResult ===\r\n                                                                                1,\r\n                                                                }\">{{\r\n                                                                        detailInfo.dailyDrawdownStatusResult ===\r\n                                                                                1\r\n                                                                                ? t(\r\n                                                                                        'Battle.label7',\r\n                                                                                        {\r\n                                                                                                price: '1,000',\r\n                                                                                        },\r\n                                                                                )\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\" v-if=\"false\">\r\n                                                                <span class=\"label\">是否有過夜持倉訂單</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.overnightPositionStatusResult ===\r\n                                                                                0,\r\n                                                                }\">{{\r\n                                                                        detailInfo.overnightPositionStatusResult ===\r\n                                                                                1\r\n                                                                                ? t('User.yes')\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\" v-if=\"false\">\r\n                                                                <span class=\"label\">是否進行了財經日曆交易</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.dataTradingType ===\r\n                                                                                1,\r\n                                                                }\">{{\r\n                                                                        detailInfo.dataTradingType ===\r\n                                                                                1\r\n                                                                                ? t('User.yes')\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.label4')\r\n                                                                }}</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.maxDrawdownStatusResult ===\r\n                                                                                1,\r\n                                                                }\">{{\r\n                                                                        detailInfo.maxDrawdownStatusResult ===\r\n                                                                                1\r\n                                                                                ? t(\r\n                                                                                        'Battle.label8',\r\n                                                                                        {\r\n                                                                                                price: '1,000',\r\n                                                                                        },\r\n                                                                                )\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\" v-if=\"false\">\r\n                                                                <span class=\"label\">是否有周末持倉訂單</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.weekendPositionStatusResult ===\r\n                                                                                0,\r\n                                                                }\">{{\r\n                                                                        detailInfo.weekendPositionStatusResult ===\r\n                                                                                1\r\n                                                                                ? t('User.yes')\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.label6')\r\n                                                                }}</span>\r\n                                                                <span class=\"value\" :class=\"{\r\n                                                                        err:\r\n                                                                                detailInfo.untradedDaysStatusResult ===\r\n                                                                                1,\r\n                                                                }\">{{\r\n                                                                        detailInfo.untradedDaysStatusResult ===\r\n                                                                                1\r\n                                                                                ? t('User.yes')\r\n                                                                                : t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('User.against')\r\n                                                                }}</span>\r\n                                                                <span class=\"value\">{{\r\n                                                                        t('User.no')\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                </div>\r\n                                        </div>\r\n                                        <div class=\"challengeBox\" v-else>\r\n                                                <div class=\"textWrap\">\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.logAccount')\r\n                                                                }}</span>\r\n                                                                <span class=\"value copyHover\" :tips=\"t('User.copy')\"\r\n                                                                        v-copy=\"detailInfo.account\">{{\r\n                                                                                detailInfo.account\r\n                                                                        }}<i class=\"copy\"\r\n                                                                                v-if=\"detailInfo.account\"></i></span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.psw')\r\n                                                                }}</span>\r\n                                                                <span class=\"value copyHover\" :tips=\"t('User.copy')\"\r\n                                                                        v-copy=\"detailInfo.password\">{{\r\n                                                                                detailInfo.password\r\n                                                                        }}<i class=\"copy\"\r\n                                                                                v-if=\"detailInfo.password\"></i></span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.server')\r\n                                                                }}</span>\r\n                                                                <span class=\"value\">{{\r\n                                                                        detailInfo.server\r\n                                                                }}</span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.email')\r\n                                                                }}</span>\r\n                                                                <span class=\"value copyHover\" :tips=\"t('User.copy')\"\r\n                                                                        v-copy=\"detailInfo.email\">{{\r\n                                                                                detailInfo.email\r\n                                                                        }}<i class=\"copy\"\r\n                                                                                v-if=\"detailInfo.email\"></i></span>\r\n                                                        </div>\r\n                                                        <div class=\"textLine\">\r\n                                                                <span class=\"label\">{{\r\n                                                                        t('Battle.phone')\r\n                                                                }}</span>\r\n                                                                <span class=\"value copyHover\" :tips=\"t('User.copy')\"\r\n                                                                        v-copy=\"detailInfo.phone\">{{\r\n                                                                                detailInfo.phone\r\n                                                                        }}<i class=\"copy\"\r\n                                                                                v-if=\"detailInfo.phone\"></i></span>\r\n                                                        </div>\r\n                                                </div>\r\n                                        </div>\r\n                                </challengeCollapseItem>\r\n                                <!-- TODO:階段三才展示资金扩展计划和高级计划模塊 -->\r\n                                <template v-if=\"detailInfo.phaseIndex === 3\">\r\n                                        <!-- 资金扩展计划-->\r\n                                        <challengeCollapseItem\r\n                                                :title=\"`${t('common.successDesc4')}: ${challengeDetailHooks.fundPlanStep}`\">\r\n                                                <div class=\"collapseTop\">\r\n                                                        <div class=\"textLine between\"\r\n                                                                v-for=\"(v, idx) in challengeDetailHooks.fundPlan\">\r\n                                                                <publicQuestionTips\r\n                                                                        :txt=\"{ faq: v.faq, label: v.label }\"\r\n                                                                        appendClass=\".user-details\">\r\n                                                                </publicQuestionTips>\r\n                                                                <span class=\"labell\">{{ v.val }}</span>\r\n                                                        </div>\r\n                                                </div>\r\n                                                <div class=\"collapseContent\">\r\n                                                        <detailsItem :list=\"challengeDetailHooks.fundPlanListH5\">\r\n                                                                <!-- 申請升級擴展計劃 1-不符合条件,2-符合条件,3-符合条件中-->\r\n                                                                <div class=\"btnGroup itemBtnGroup\">\r\n                                                                        <button class=\"btn deep\" @click=\"upgradeScalingPlan(detailInfo)\"\r\n                                                                                v-if=\"detailInfo.phaseIndex === 3\"\r\n                                                                                :class=\"{ disabled: detailInfo.scalingPlan?.checkExpandPlansConditionCode !== '2' }\">\r\n                                                                                {{ t('User.txt30') }}\r\n                                                                        </button>\r\n                                                                </div>\r\n                                                        </detailsItem>\r\n                                                </div>\r\n                                        </challengeCollapseItem>\r\n                                        <!-- 高级计划-->\r\n                                        <challengeCollapseItem\r\n                                                :title=\"`${t('common.bar4')}: ${t(challengeDetailHooks.seniorLev1)}`\">\r\n                                                <div class=\"collapseTop\">\r\n                                                        <div class=\"textLine between\"\r\n                                                                v-for=\"(v, idx) in challengeDetailHooks.premiumPlan\">\r\n                                                                <publicQuestionTips\r\n                                                                        :txt=\"{ faq: v.faq, label: v.label }\"\r\n                                                                        appendClass=\".user-details\">\r\n                                                                </publicQuestionTips>\r\n                                                                <span class=\"labell\">{{ t(v.val) }}</span>\r\n                                                        </div>\r\n                                                </div>\r\n                                                <div class=\"collapseContent\">\r\n                                                        <detailsItem :list=\"challengeDetailHooks.premiumPlanListH5\">\r\n                                                                <div class=\"btnGroup itemBtnGroup\">\r\n                                                                        <!-- 滿足高級計劃申請條件 -->\r\n                                                                        <button class=\"btn deep\" @click=\"upgradeSenior(detailInfo)\"\r\n                                                                            :class=\"{ disabled: !challengeDetailHooks.btnUpgradeSenior }\"\r\n                                                                            v-if=\"detailInfo.phaseIndex === 3 && (challengeDetailHooks.seniorLev2 === 'User.txt14')\">\r\n                                                                            {{ t('User.txt36') }}\r\n                                                                        </button>\r\n                                                                        <!-- 合并按钮:查询列表接口没返回数据时，代表已合并过挑战 -->\r\n                                                                        <button class=\"btn deep\" @click=\"mergeHandler(detailInfo)\"\r\n                                                                            :class=\"{ disabled: mergeList?.length === 0 }\"\r\n                                                                            v-if=\"mergeList && detailInfo.phaseIndex === 3 && (challengeDetailHooks.seniorLev1 === 'User.txt32')\">\r\n                                                                            {{ mergeList?.length === 0 ? t('User.txt37') : t('Home.challenge.text11') }}\r\n                                                                        </button>\r\n                                                                </div>\r\n                                                        </detailsItem>\r\n                                                </div>\r\n                                        </challengeCollapseItem>\r\n                                </template>\r\n                                <div class=\"btnGroup\">\r\n                                        <template v-if=\"detailInfo.status == 0\"><!--挑战中-->\r\n                                                <button class=\"btn deep\"\r\n                                                        v-if=\"challengeDetailHooks.btnUpgradeSettlement\"\r\n                                                        @click=\"bindCallUpGrade(detailInfo, 0,)\">\r\n                                                        {{ t('User.btn5') }}\r\n                                                </button>\r\n                                                <template v-if=\"challengeDetailHooks.btnMT5\">\r\n                                                        <nuxt-link-locale class=\"btn deep\"\r\n                                                                :to=\"`${APP_MC_MARKETS}/en-US/login?actionType=login`\"\r\n                                                                target=\"_blank\">MC Markets</nuxt-link-locale>\r\n                                                        <nuxt-link-locale class=\"btn light\" :to=\"APP_MT5\"\r\n                                                                target=\"_blank\">MT5</nuxt-link-locale>\r\n                                                </template>\r\n                                                <!-- 確認結算 -->\r\n                                                <button class=\"btn deep\" @click=\"bindCallUpGrade(detailInfo, 1)\"\r\n                                                        v-if=\"challengeDetailHooks.btnSettlement\">\r\n                                                        {{ t('User.btn7') }}\r\n                                                </button>\r\n                                        </template>\r\n                                        <div class=\"detail-fail\" v-if=\"detailInfo.status == 2\">\r\n                                                <!--挑战失败-->\r\n                                                <button class=\"btn deep\" @click=\"bindDoFail\">\r\n                                                        {{ t('User.btn7') }}\r\n                                                </button>\r\n                                                <button class=\"btn light\" v-if=\"detailInfo.phaseIndex != 3\"\r\n                                                        @click=\"publicFailRePaymentRef.shower\">\r\n                                                        {{ t('User.btn6') }}\r\n                                                </button>\r\n                                        </div>\r\n                                </div>\r\n                        </div>\r\n                </div>\r\n                <!---挑战升级/结算弹窗-->\r\n                <publicUpGrade ref=\"publicUpGradeRef\" :data=\"upGradeData\"></publicUpGrade>\r\n                <!---交易天数--->\r\n                <publicTipsPopup ref=\"publicTipsRef\" :content=\"tipsContent\" maskBG=\"rgba(0,0,0,0)\" :isBtnGroup=\"false\">\r\n                </publicTipsPopup>\r\n                <!---挑战失败继续支付-->\r\n                <publicFailRePayment ref=\"publicFailRePaymentRef\" :data=\"detailInfo\"></publicFailRePayment>\r\n                <mergePopup ref=\"mergePopupRef\"></mergePopup>\r\n        </div>\r\n</template>\r\n<script setup>\r\nimport { APP_MC_MARKETS, APP_MT5 } from '@/config/app';\r\nimport { formatNumberWithCurrency, subtract } from '@/utils/tools'\r\nimport { getUserInfo, getChallengeDetail, bindSettlementFail, getChallengeScalingPlan, getChallengeSeniorPlan, upgradeToScalingPlan, upgradeToSeniorPlan } from '@/api/challenge'\r\nimport { ElTooltip, ElLoading } from 'element-plus'\r\nimport { computed } from 'vue'\r\nimport challengeCollapseItem from \"@/components/user/home/challengeDetailPopup/challengeCollapseItem.vue\"\r\nimport { useChallengeDetails } from \"@/hooks/useChallengeDetails.js\"\r\nimport mergePopup from \"@/components/user/home/challengeDetailPopup/mergePopup.vue\"\r\nimport detailsItem from \"./detailsItem.vue\"\r\nimport { useAccount } from \"@/hooks/useAccount\";\r\n\r\nconst { userInfo } = useAccount()\r\n// hooks返回值\r\nlet challengeDetailHooks = ref({})\r\nconst getHooksParam = (detailInfo) => {\r\n        let res = useChallengeDetails(detailInfo)\r\n\r\n        Object.keys(res).map(key => {\r\n                challengeDetailHooks.value[key] = res[key]\r\n        })\r\n}\r\n\r\nconst route = useRoute()\r\nconst { t } = useI18n()\r\nconst detailInfo = ref({})\r\nconst upGradeData = ref({})\r\nconst publicUpGradeRef = ref(null)\r\nconst publicTipsRef = ref()\r\nconst publicFailRePaymentRef = ref()\r\nconst tipsContent = ref('')\r\nconst initData = ref({\r\n        loading: true,\r\n        list: [],\r\n})\r\nlet mergeList = ref([])\r\n// 合并弹窗\r\nconst mergePopupRef = ref()\r\nconst collapseTitle = computed(() => {\r\n        let status = detailInfo.value.status == 0 ? t('Battle.tips6') : detailInfo.value.status == 1 ? t('User.tips4') : detailInfo.value.status == 2 ? t('User.tips5') : t('User.tips19')\r\n        return `${t('Battle.txt7')} ${status}`\r\n})\r\nconst collapseTitleColor = computed(() => {\r\n        let status = detailInfo.value.status < 2 ? \"#50D183\" : detailInfo.value.status == 2 ? '#FF4A37' : \"#fff\"\r\n        return status\r\n})\r\n\r\nconst setChallengeList = (list) => {\r\n        for (let key in list) {\r\n                detailInfo.value[key] = list[key]\r\n        }\r\n        detailInfo.value.isUserUp = detailInfo.value.isUserUp === 'true'\r\n\r\n        detailInfo.value.phaseIndex = +detailInfo.value.phaseIndex\r\n        if (detailInfo.value.phaseIndex === 3) {\r\n                getMergeTradeAccountList(detailInfo)\r\n        }\r\n}\r\n\r\nconst bindShowChallengeDetail = async () => {\r\n        const uid = route.query.uid\r\n        //打开挑战详情弹窗\r\n        const param = { tradingChallengeUid: uid }\r\n        const loading = ElLoading.service({\r\n                lock: true,\r\n                text: 'Loading',\r\n                background: 'rgba(0, 0, 0, 0.7)',\r\n        })\r\n        let challengeDetailRes = await getChallengeDetail(param)\r\n        // 挑戰詳情擴展計劃\r\n        let challengeScalingPlanRes = await getChallengeScalingPlan({ challengeUid: uid })\r\n        // 挑战详情高級計劃\r\n        let ChallengeSeniorPlanRes = await getChallengeSeniorPlan({ challengeUid: uid })\r\n        if (detailInfo.phaseIndex === 3) {\r\n                getMergeTradeAccountList(detailInfo)\r\n        }\r\n        detailInfo.value = deepClone(challengeDetailRes.data)\r\n        setChallengeList(route.query)\r\n        const anw = challengeDetailRes.data.accountNetWrth ? challengeDetailRes.data.accountNetWrth : 0\r\n        const dsnw = challengeDetailRes.data.dailySettlementNetWrth ? challengeDetailRes.data.dailySettlementNetWrth : 0\r\n        const ddnw = challengeDetailRes.data.maxDailyDrawdown ? challengeDetailRes.data.maxDailyDrawdown : 0\r\n        const tdnw = challengeDetailRes.data.maxTotalDrawdown ? challengeDetailRes.data.maxTotalDrawdown : 0\r\n        detailInfo.value.minAccountDdnw = subtract(dsnw, ddnw)\r\n        detailInfo.value.minAccountTdnw = subtract(dsnw, tdnw)\r\n        detailInfo.value.scalingPlan = challengeScalingPlanRes.data\r\n        detailInfo.value.seniorPlan = ChallengeSeniorPlanRes.data\r\n        getHooksParam(detailInfo.value)\r\n        loading.close()\r\n}\r\n\r\nconst bindCallUpGrade = (data, type) => {\r\n        //打开升级弹窗\r\n        const { phaseIndex, withdrawalAmount, platform, account, uid, orderNo, withdrawCount, renewSignUpCost, profitSharingRatio } = data\r\n        let res = {\r\n                level: phaseIndex,\r\n                amount: withdrawalAmount, //結算金額\r\n                platform,\r\n                account,\r\n                tradingChallengeId: uid,\r\n                withdrawType: type,\r\n                orderNo,\r\n                withdrawCount,\r\n                renewSignUpCost,\r\n                profitSharingRatio,\r\n        }\r\n        upGradeData.value = res\r\n        publicUpGradeRef.value.shower()\r\n}\r\n\r\nbindShowChallengeDetail()\r\nonMounted(() => {\r\n        getUserInfo().then((res) => {\r\n                initData.value.total = res.data.totalProfit\r\n                initData.value.times = res.data.withdrawCount\r\n        })\r\n})\r\nconst bindDoFail = () => {\r\n        //失败结算\r\n        bindSettlementFail({ tradingChallengeUid: route.query.uid }).then((res) => {\r\n                detailInfo.value.status = 3\r\n                ElMessage.warning(t('User.settled'))\r\n        })\r\n}\r\n\r\nconst bindTradeDayTips = (txt) => {\r\n        tipsContent.value = t(txt)\r\n        publicTipsRef.value.shower()\r\n}\r\n// 申請升級\r\nconst upgradeScalingPlan = async (data) => {\r\n        try {\r\n                let res = await upgradeToScalingPlan({ challengeUid: data.uid })\r\n                if (res.code === 200) {\r\n                        // 升级后更新账号总规模\r\n                        challengeDetailHooks.value.getExpandPlansAccount(res.data.expandAmount)\r\n                        bindTradeDayTips(t('User.txt31'))\r\n                }\r\n        } catch (err) {\r\n                bindTradeDayTips(\"不滿足升級條件\")\r\n        }\r\n}\r\nconst upgradeSenior = async (data) => {\r\n        try {\r\n                let res = await upgradeToSeniorPlan({ challengeUid: data.uid })\r\n                if (res.code === 200) {\r\n                        bindTradeDayTips(t('User.txt31'))\r\n                }\r\n        } catch (err) {\r\n                bindTradeDayTips(\"不滿足升級條件\")\r\n        }\r\n}\r\n// 合并列表\r\nconst getMergeTradeAccountList = async (detailInfo) => {\r\n        let params = {\r\n                email: userInfo.value?.data.email ?? \"\",\r\n                phone: userInfo.value?.data.phone ?? \"\",\r\n                phoneCode: \"\",\r\n                userId: detailInfo.userId ?? \"\"\r\n        }\r\n        try {\r\n                // let test = [\r\n                //         {\r\n                //                 orderId: \"10001\",\r\n                //                 level: 3,\r\n                //                 accountSize: 10000,\r\n                //                 currentEquity: 10008,\r\n                //                 profitStatus: \"进行中\",\r\n                //                 currentPositionCount: \"进行中\",\r\n                //                 paymentAmount: 0,\r\n                //         },\r\n                //         {\r\n                //                 orderId: \"10002\",\r\n                //                 level: 3,\r\n                //                 accountSize: 10009,\r\n                //                 currentEquity: 10000,\r\n                //                 profitStatus: \"通过\",\r\n                //                 currentPositionCount: \"通过\",\r\n                //                 paymentAmount: 0,\r\n                //         },\r\n                // ]\r\n                let res = await mergeTradeAccountList(params)\r\n                mergeList.value = res.data\r\n        } catch (err) {\r\n                mergeList.value = null\r\n        }\r\n}\r\n// 打开合并弹窗\r\nconst mergeHandler = (detailInfo) => {\r\n        getMergeTradeAccountList(detailInfo)\r\n        mergePopupRef.value.show(mergeList.value)\r\n}\r\n</script>\r\n<style scoped lang=\"scss\" src=\"./index.scss\"></style>\r\n"],"names":["detailInfo"],"mappings":"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"}