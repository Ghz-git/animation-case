{"file":"index-BGuNJq9x.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA,UAAM,EAAE,EAAC,IAAK;AACd,UAAM,YAAY,IAAI,KAAK;AAC3B,UAAM,aAAa,IAAI,IAAI;AAC3B,UAAM,QAAQ,IAAI,IAAI;AAEtB,UAAM,UAAU,SAAS,QAAQ;AACjC,UAAM,kBAAkB,IAAI,CAAA,CAAE;AAC9B,QAAI,OAAO,IAAI,CAAA,CAAE;AACjB,QAAI,YAAY,IAAI,EAAE;AACtB,QAAI,QAAQ,IAAI,CAAC;AACjB,QAAI,WAAW,IAAI,CAAC;AACpB,QAAI,YAAY,SAAS,MAAM;AAC3B,YAAM,MAAM,oBAAI,IAAK;AACrB,UAAI,KAAK,SAAS,KAAK,UAAU,KAAK,KAAK,MAAM,MAAM;AACnD,mBAAW,CAAC,KAAK,GAAG,KAAK,OAAO,QAAQ,KAAK,KAAK,GAAG;AACjD,cAAI,IAAI,KAAK,GAAG;AAAA,QACnB;AAAA,MACJ;AACD,aAAO;AAAA,IACX,CAAC;AAED,UAAM,UAAU,CAAC,QAAQ;AACrB,WAAK,QAAQ,gBAAgB,MAAM,IAAI,EAAE;AACzC,YAAM,QAAQ,UAAU,MAAM,IAAI,EAAE;AACpC,eAAS,QAAQ,IAAI;AAAA,IACzB;AACA,UAAM,SAAS,CAAC,cAAc;AAC1B,UAAI,QAAQ,MAAM,MAAM,cAAc,MAAM,MAAM,eAAe,MAAM,MAAM;AAC7E,oBAAc,KAAM,MAAM,MAAM,cAAc,MAAQ,MAAM,MAAM,cAAc;AAChF,gBAAU,QAAQ,MAAM,MAAM,eAAe,IAAI,QAAQ;AACzD,iBAAW,QAAQ,QAAQ,QAAQ;AAAA,IACvC;AACA,UAAM,aAAa,MAAM;AACrB,aAAO,EAAE;AAAA,IACb;AACA,UAAM,cAAc,MAAM;AACtB,aAAO,CAAC;AAAA,IACZ;AAGY,IAAA,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,OAAO,0BAAwB,CAAA;AAmIjD,UAAM,YAAY,CAAC,QAAQ;AACvB,UAAI,OAAO,QAAQ,UAAU;AACzB,eAAO,IAAI,SAAS,GAAG,IAAI,EAAE,GAAG,IAAI,QAAQ,SAAS,OAAO;AAAA,MACpE,OAAW;AACH,eAAO,QAAQ,SAAS,OAAO,IAAI,GAAG;AAAA,MACzC;AAAA,IACL;AAIA,UAAM,SAAS,MAAM;AACjB,aAAO,SAAS;AAAA,QACZ,KAAK,SAAS;AAAA,MACtB,CAAK;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":["_withAsyncContext"],"sources":["../../../../src/pages/challenges/index/components/scalingPlan/index.vue"],"sourcesContent":["<template>\r\n    <div id=\"scaling-plan\">\r\n        <publicMWrap :title=\"t('Challenges.ScalingPlan.title')\">\r\n            <div class=\"scaling-plan\">\r\n                <publicTabBar :tabList=\"tabList\" @trigger=\"trigger\"></publicTabBar>\r\n                <div class=\"scaling-plan-wrap\" ref=\"table\">\r\n                    <div class=\"scaling-plan__tables\">\r\n                        <div class=\"t-header\" v-for=\"[key, items] in tableList\" :key=\"key\">\r\n                            <div class=\"th tr\">{{ t(key) }}<i class=\"gap\"></i></div>\r\n                            <div class=\"td tr\" v-for=\"(val, idx) in items\" :key=\"idx\">{{ filterVal(val) }}<i\r\n                                    class=\"gap\"></i></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"scaling-plan__control\">\r\n                    <div class=\"opt pre\" :class=\"{ active: preActive }\" @click=\"preHandler\">\r\n                        <img src=\"../../../../../assets/images/icons/back.png\" />\r\n                    </div>\r\n                    <div class=\"opt next\" :class=\"{ active: nextActive }\" @click=\"nextHandler\">\r\n                        <img src=\"../../../../../assets/images/icons/back.png\" />\r\n                    </div>\r\n                </div>\r\n                <div class=\"scaling-plan__tips\">{{ t('Challenges.ScalingPlan.tips') }}</div>\r\n                <button class=\"scaling-plan__btn\" @click=\"linkTo\">{{ t('Challenges.ScalingPlan.buy') }} ${{\r\n                    formatPrice(price) }}</button>\r\n            </div>\r\n        </publicMWrap>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { TAB_LIST, SCALING_PLAN_TH } from \"@/data\";\r\nimport { reactive, computed, ref, onMounted } from \"vue\"\r\nimport { useChallenges } from \"@/store/challenges\"\r\nimport { percentHandler, formatPrice } from \"@/utils/tools\"\r\n\r\nconst { t } = useI18n();\r\nconst preActive = ref(false);\r\nconst nextActive = ref(true);\r\nconst table = ref(null)\r\n\r\nconst tabList = reactive(TAB_LIST);\r\nconst scalingPlanList = ref([]);\r\nlet list = ref({});\r\nlet priceList = ref([]) // 按鈕價格list\r\nlet price = ref(0)\r\nlet battleId = ref(0)\r\nlet tableList = computed(() => {\r\n    const res = new Map()\r\n    if (list.value && JSON.stringify(list.value) !== \"{}\") {\r\n        for (const [key, val] of Object.entries(list.value)) {\r\n            res.set(key, val)\r\n        }\r\n    }\r\n    return res\r\n})\r\n// 等級切換\r\nconst trigger = (tab) => {\r\n    list.value = scalingPlanList.value[tab.id]\r\n    price.value = priceList.value[tab.id]\r\n    battleId.value = tab.id\r\n}\r\nconst scroll = (direction) => {\r\n    let isEnd = table.value.clientWidth + table.value.scrollLeft === table.value.scrollWidth\r\n    direction === -1 ? (table.value.scrollLeft -= 200) : (table.value.scrollLeft += 200)\r\n    preActive.value = table.value.scrollLeft === 0 ? false : true\r\n    nextActive.value = isEnd ? false : true\r\n}\r\nconst preHandler = () => {\r\n    scroll(-1)\r\n}\r\nconst nextHandler = () => {\r\n    scroll(1)\r\n}\r\n\r\n// 獲取json配置數據\r\nconst cfd = await import('@/data/challenges.json')\r\n\r\n// 處理每一項數據\r\nconst tdHandler = (item, fn) => {\r\n    if (!item || typeof item !== \"string\") return fn([\"--\", \"--\", \"--\"])\r\n    let res = []\r\n    res = item.split(\",\")\r\n    fn(res)\r\n}\r\n\r\n// 處理成map數據\r\nconst formatMap = (arr) => {\r\n    let res = []\r\n\r\n    arr.forEach((item, idx) => {\r\n        let share = `level${idx + 1}`\r\n        let level = {}\r\n        let td1 = [] // level1\r\n        let td2 = [] // level2\r\n        let td3 = [] // level3\r\n\r\n        // 賬戶規模\r\n        td1.push(`$${item.initialAmount.toLocaleString()}`)\r\n        td2.push(`$${item.initialAmount.toLocaleString()}`)\r\n        td3.push(`$${item.initialAmount.toLocaleString()}`)\r\n\r\n        // 處理\"利潤目標\"字段\r\n        tdHandler(item.profitTarget, (profitTarget) => {\r\n            td1.splice(2, 0, percentHandler(profitTarget[0]))\r\n            td2.splice(2, 0, percentHandler(profitTarget[1]))\r\n            td3.splice(2, 0, percentHandler(profitTarget[2]))\r\n        })\r\n\r\n        // 處理\"每日最大回撤\"字段\r\n        tdHandler(item.dailyDrawdown, (dailyDrawdown) => {\r\n            td1.splice(3, 0, percentHandler(dailyDrawdown[0]))\r\n            td2.splice(3, 0, percentHandler(dailyDrawdown[1]))\r\n            td3.splice(3, 0, percentHandler(dailyDrawdown[2]))\r\n        })\r\n\r\n        // 處理\"最大回撤\"字段\r\n        tdHandler(item.maxDrawdown, (maxDrawdown) => {\r\n            td1.splice(4, 0, percentHandler(maxDrawdown[0]))\r\n            td2.splice(4, 0, percentHandler(maxDrawdown[1]))\r\n            td3.splice(4, 0, percentHandler(maxDrawdown[2]))\r\n        })\r\n\r\n        // 處理\"賬戶類型\"字段\r\n        td1.splice(1, 0, t(\"Challenges.ScalingPlan.demo\"))\r\n        td2.splice(1, 0, t(\"Challenges.ScalingPlan.demo\"))\r\n        td3.splice(1, 0, t(\"Challenges.ScalingPlan.real\"))\r\n\r\n        // 處理\"分潤\"字段; (json配置)\r\n        tdHandler(cfd[share].share, (shareRatio) => {\r\n            td1.splice(5, 0, shareRatio[0])\r\n            td2.splice(5, 0, shareRatio[1])\r\n            td3.splice(5, 0, shareRatio[2])\r\n        })\r\n\r\n        // 處理\"每個階段可提取的利潤\"字段\r\n        tdHandler(item.profitSharing, (profitSharing) => {\r\n            td1.splice(7, 1, profitSharingHandler(formatPrice(+profitSharing[0])))\r\n            td2.splice(7, 1, profitSharingHandler(formatPrice(+profitSharing[1])))\r\n            td3.splice(7, 1, profitSharingHandler(formatPrice(+profitSharing[2])))\r\n        })\r\n\r\n        // 處理\"續費挑戰\"字段\r\n        // tdHandler(cfd[share].renewal,(renewal)=>{\r\n        //     td1.push(formatPrice(renewal[0]))\r\n        //     td2.push(formatPrice(renewal[1]))\r\n        //     td3.push(formatPrice(renewal[2]))\r\n        // })\r\n        tdHandler(item.renewSignUpCost, (renewal) => {\r\n            td1.push(profitSharingHandler(formatPrice(+renewal[0]), false))\r\n            td2.push(profitSharingHandler(formatPrice(+renewal[1]), false))\r\n            td3.push(profitSharingHandler(formatPrice(+renewal[2]), false))\r\n        })\r\n\r\n        // 處理\"有效挑戰天數\"字段\r\n        tdHandler(item.validTradingDays, (validTradingDays) => {\r\n            td1.push(validTradingDays[0])\r\n            td2.push(validTradingDays[1])\r\n            td3.push(validTradingDays[2])\r\n        })\r\n\r\n\r\n        // 處理\"有效挑战天数的下单次数\"字段\r\n        tdHandler(item.minTransactionTimes, (minTransactionTimes) => {\r\n            td1.push(minTransactionTimes[0])\r\n            td2.push(minTransactionTimes[1])\r\n            td3.push(minTransactionTimes[2])\r\n        })\r\n\r\n        // 判斷是\"大師級階段\"、\"專家級階段\"、\"入門級階段\"\r\n        let levStage = item.level === 1 ? \"Challenges.ScalingPlan.tableHeader.th14\" : item.level === 2 ? \"Challenges.ScalingPlan.tableHeader.th13\" : \"Challenges.ScalingPlan.tableHeader.th1\"\r\n        level[levStage] = SCALING_PLAN_TH\r\n        level[\"Challenges.ScalingPlan.tableHeader.th10\"] = td1\r\n        level[\"Challenges.ScalingPlan.tableHeader.th11\"] = td2\r\n        level[\"Challenges.ScalingPlan.tableHeader.th12\"] = td3\r\n\r\n        res.push(level)\r\n        priceList.value.push(item.enrollmentFee)\r\n    })\r\n    price.value = priceList.value[0]\r\n    return res\r\n}\r\n//\"每個階段可提取的利潤\" 添加千分位分割和$\r\nconst profitSharingHandler = (price, isLimit = true) => {\r\n    return price !== \"NaN\" ? `$${price}` : isLimit ? \"Challenges.ScalingPlan.withdrawable\" : \"--\"\r\n}\r\n\r\n// 獲取數據\r\nconst getList = () => {\r\n    let res = []\r\n    let timer = null\r\n    //獲取請求數據\r\n    timer = setInterval(() => {\r\n        res = useChallenges().scalingPlan\r\n        res.map((item) => {\r\n            item.levelTag = `Home.challenge.level${item.level}.name`\r\n        })\r\n        scalingPlanList.value = formatMap(res)\r\n        scalingPlanList.value[0] && (list.value = scalingPlanList.value[0])\r\n        if (res) {\r\n            clearInterval(timer)\r\n        }\r\n    }, 300)\r\n\r\n}\r\n\r\n// 判斷是否需要使用t()以及處理數據為null的情況\r\nconst filterVal = (val) => {\r\n    if (typeof val === \"string\") {\r\n        return val.includes(\".\") ? t(val) : val === \"null\" ? \"--\" : val\r\n    } else {\r\n        return val === \"null\" ? \"--\" : `$${val}`\r\n    }\r\n}\r\nonMounted(() => {\r\n    getList()\r\n})\r\nconst linkTo = () => {\r\n    nuxtTo(\"/user\", {\r\n        idx: battleId.value\r\n    })\r\n}\r\n</script>\r\n<style scoped lang='scss' src=\"./index.scss\"></style>"],"version":3}