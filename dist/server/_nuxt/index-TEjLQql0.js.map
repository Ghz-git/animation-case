{"version":3,"file":"index-TEjLQql0.js","sources":["../../../../src/assets/images/loginBG.jpg","../../../../src/pages/forgetPassword/index.vue"],"sourcesContent":["export default \"__VITE_ASSET__DK4wWYYg__\"","<template>\r\n\t<div class=\"loginMain\" :style=\"{ backgroundImage: `url(${loginBG})`, backgroundSize: 'cover', backgroundRepeat: 'no-repeat', backgroundPosition: 'center center' }\" @click=\"formClass.bindPhonePrefixListClose\">\r\n\t\t<div class=\"content\">\r\n\t\t\t<div class=\"loginCel\">\r\n\t\t\t\t<p class=\"title\">\r\n                                        {{ t(\"Login.forget\") }}\r\n                                        <img class=\"back\" src=\"../../assets/images/icons/back.png\" @click.stop=\"bindPageBack\" />\r\n                                </p>\r\n\t\t\t\t<div class=\"forgetWrap\"></div>\r\n<!--\t\t\t\t<div class=\"inputWrap\" :class=\"{ focus: item.isFocus, error: item.isError }\"-->\r\n<!--\t\t\t\t\tv-for=\"(item, index) in formList\" :key=\"index\" @click.stop=\"stop\">-->\r\n<!--\t\t\t\t\t<div class=\"inputItem\">-->\r\n<!--\t\t\t\t\t\t<p class=\"phoneArea\" :class=\"{ active: item.isOpenList }\" v-if=\"item.type === 'phone'\"-->\r\n<!--\t\t\t\t\t\t\t@click.stop=\"formClass.bindPhonePrefixListTransfer(index)\"><img alt=\"\"-->\r\n<!--\t\t\t\t\t\t\t\t:src=\"item.areaFlag\" />+{{ item.phonePrefix }}<i class=\"iconfont icon-xiangxia\"></i></p>-->\r\n<!--\t\t\t\t\t\t<input :type=\"item.inputType\" class=\"in\" :placeholder='t(item.placeholder)'-->\r\n<!--\t\t\t\t\t\t\t@focus=\"formClass.bindChildFocus(index)\" @blur=\"formClass.bindChildBlur(index)\"-->\r\n<!--\t\t\t\t\t\t\t@input=\"formClass.bindChildInputCheck(index)\" v-model=\"item.value\" />-->\r\n<!--\t\t\t\t\t\t<img class=\"icon\" src=\"../../assets/images/icons/clear.png\" v-if=\"item.value.length > 0\"-->\r\n<!--                                                     @click.stop=\"formClass.bindChildClear(index)\" />-->\r\n<!--\t\t\t\t\t\t<img class=\"icon\" src=\"../../assets/images/icons/eyes1.png\"-->\r\n<!--\t\t\t\t\t\t\tv-if=\"item.isPassword && item.inputType === 'password'\"-->\r\n<!--\t\t\t\t\t\t\t@click.stop=\"formClass.bindChildChangeInputType(index, 'text')\" />-->\r\n<!--\t\t\t\t\t\t<img class=\"icon\" src=\"../../assets/images/icons/eyes2.png\"-->\r\n<!--\t\t\t\t\t\t\tv-if=\"item.isPassword && item.inputType === 'text'\"-->\r\n<!--\t\t\t\t\t\t\t@click.stop=\"formClass.bindChildChangeInputType(index, 'password')\" />-->\r\n<!--\t\t\t\t\t\t<span class=\"getCode\" v-if=\"item.type === 'validCode'\" @click=\"bindStartCode\">-->\r\n<!--\t\t\t\t\t\t\t{{ t(item.codeData.sendText) }} <span v-if=\"item.codeData.isShow\">({{ item.codeData.sendTime-->\r\n<!--\t\t\t\t\t\t\t\t}}s)</span>-->\r\n<!--\t\t\t\t\t\t</span>-->\r\n<!--\t\t\t\t\t\t<div class=\"phoneAreaList\" :class=\"{ active: item.isOpenList }\" v-if=\"item.type === 'phone'\">-->\r\n<!--\t\t\t\t\t\t\t<div class=\"searchWrap\">-->\r\n<!--\t\t\t\t\t\t\t\t<div class=\"search\">-->\r\n<!--\t\t\t\t\t\t\t\t\t<i class=\"iconfont icon-sousuo\"></i>-->\r\n<!--\t\t\t\t\t\t\t\t\t<input class=\"in\" v-model=\"item.searchPrefixKey\"-->\r\n<!--\t\t\t\t\t\t\t\t\t\t@input=\"formClass.bindSetPrefixList(index)\" />-->\r\n<!--\t\t\t\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t\t\t<div class=\"inner\">-->\r\n<!--\t\t\t\t\t\t\t\t<p class=\"item\" :class=\"{ active: pre.isSelect }\"-->\r\n<!--\t\t\t\t\t\t\t\t\tv-for=\"(pre, idx2) in item.phonePrefixList\" :key=\"idx2\"-->\r\n<!--\t\t\t\t\t\t\t\t\t@click.stop=\"formClass.bindResetPhonePrefix(index, idx2)\">-->\r\n<!--\t\t\t\t\t\t\t\t\t<span class=\"country\">-->\r\n<!--\t\t\t\t\t\t\t\t\t\t<img alt=\"\" :src=\"pre.flag\" />{{ pre.area }}-->\r\n<!--\t\t\t\t\t\t\t\t\t</span>-->\r\n<!--\t\t\t\t\t\t\t\t\t<span>+{{ pre.prefix }}</span>-->\r\n<!--\t\t\t\t\t\t\t\t</p>-->\r\n<!--\t\t\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t<div class=\"checkPwdArea\" :class=\"{ active: item.value.length > 0 && !item.checkPwdData.isCheckOK }\"-->\r\n<!--\t\t\t\t\t\tv-if=\"item.type === 'password'\">-->\r\n<!--\t\t\t\t\t\t<p class=\"text\" :class=\"{ ok: rule.bol }\" v-for=\"(rule, index2) in item.checkPwdData.rules\"-->\r\n<!--\t\t\t\t\t\t\t:key=\"index2\">-->\r\n<!--\t\t\t\t\t\t\t<i class=\"iconfont icon-gouxuan\" v-if=\"rule.bol\"></i>-->\r\n<!--\t\t\t\t\t\t\t<i class=\"iconfont icon-guanbi\" v-else></i>-->\r\n<!--\t\t\t\t\t\t\t<span>{{ t(rule.str) }}</span>-->\r\n<!--\t\t\t\t\t\t</p>-->\r\n<!--\t\t\t\t\t</div>-->\r\n<!--\t\t\t\t\t<p class=\"inputTips\" v-if=\"item.tips.length > 0\">{{ t(item.tips) }}</p>-->\r\n<!--\t\t\t\t</div>-->\r\n                                <publicInputForm :formList=\"formList\" :formClass=\"formClass\"></publicInputForm>\r\n\t\t\t\t<button class=\"subBtn\" @click=\"bindDoChangePassword(formList)\">{{ t(\"Login.btn2\") }}</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!--\t\t<button id=\"captcha-button\">button</button>-->\r\n<!--\t\t<div id=\"captcha-element\"></div>-->\r\n\t</div>\r\n</template>\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport loginBG from \"@/assets/images/loginBG.jpg\"\r\nimport { extractKeys, feedBackData, modeList } from \"@/config/inputClass\"\r\nimport { bindResetPwd } from \"@/api/login\"\r\nimport { useCheckMobile } from \"@/store/isMobile\";\r\nimport { stop } from \"@/utils/tools\";\r\nimport { ga4 } from \"@/utils/ga4\";\r\nimport { useCaptcha } from \"@/hooks/useCaptcha\"\r\nimport { useAccount } from \"@/hooks/useAccount\"\r\nconst { bindDoChangePassword } = useAccount()\r\n\r\ndefinePageMeta({\r\n\tlayout: 'header'\r\n})\r\n\r\nconst pageType = ref(1)\r\nconst route = useRoute()\r\npageType.value = route.query.type ? Number(route.query.type) : 1\r\nconst { t } = useI18n()\r\n// const submitBol = ref(false)\r\n\r\nlet formArr = []\r\nformArr = pageType.value === 1 ? [\"email\", \"validCode\", \"password\", \"checkPassword\"] : [\"phone\", \"validCode\", \"password\", \"checkPassword\"]\r\nconst formClass = ref(new modeList(formArr))\r\nconst formList = ref(formClass.value.list)\r\nconst historyUrl = ref()\r\n\r\n// const doChangePassword = () => {\r\n// \tconst data = feedBackData(formList.value)\r\n// \tif (!data) {\r\n// \t\tElMessage.error(t(\"Login.inputTips10\"))\r\n// \t\treturn;\r\n// \t}\r\n// \tconst loading = ElLoading.service({\r\n// \t\tlock: true,\r\n// \t\tbackground: 'rgba(0, 0, 0, 0.5)',\r\n// \t})\r\n// \tconst arr = pageType.value === 1 ? [\"email\", \"validCode\", \"password\"] : [\"phone\", \"validCode\", \"password\", \"phonePrefix\"]\r\n// \tconst param = extractKeys(data, arr)\r\n// \tif (!submitBol.value) {\r\n// \t\tsubmitBol.value = true\r\n// \t\tbindResetPwd(param).then(() => {\r\n// \t\t\tloading.close()\r\n// \t\t\tsubmitBol.value = false\r\n// \t\t\tElMessage.success(t(\"Login.pwdChanged\"))\r\n// \t\t\tconst localePath = useLocalePath()\r\n// \t\t\tsetTimeout(() => {\r\n// \t\t\t\tif (source === 'app') {\r\n// \t\t\t\t\tuni.navigateTo({ url: \"/pages/login/index\" })\r\n// \t\t\t\t} else {\r\n// \t\t\t\t\tnavigateTo({\r\n// \t\t\t\t\t\tpath: localePath('/login'),\r\n// \t\t\t\t\t})\r\n// \t\t\t\t}\r\n// \t\t\t}, 500)\r\n// \t\t}).catch(() => {\r\n// \t\t\tloading.close()\r\n// \t\t\tsubmitBol.value = false\r\n// \t\t})\r\n// \t}\r\n// }\r\n\r\nconst source = route.query.source\r\nconst bindPageBack = () => {\r\n\tconst router = useRouter();\r\n\tif (source === 'app') {\r\n\t\tuni.navigateBack()\r\n\t} else if (!historyUrl.value) {\r\n\t\tnuxtTo('/')\r\n\t} else {\r\n\t\trouter.back()\r\n\t}\r\n\r\n};\r\n// const bindStartCode = () => {\r\n// \tconst button = document.getElementById('captcha-button')\r\n// \tconst idx = formClass.value.list.findIndex(item => item.type === \"email\" || item.type === \"phone\");\r\n// \tconst i = formClass.value.list.findIndex(item => item.type === \"validCode\");\r\n// \tif (idx !== -1) {\r\n// \t\tformClass.value.bindChildBlur(idx);\r\n// \t\tif (formClass.value.list[idx].isOK && !formClass.value.list[i].codeData.isSend) {\r\n// \t\t\tbutton.click()\r\n// \t\t}\r\n// \t}\r\n// }\r\n// let captcha = null\r\nonMounted(() => {\r\n\tga4({\r\n\t\ttypes: \"first_visit\",\r\n\t\tparams: {\r\n\t\t\t\"page_name\": \"Forget Password\",\r\n\t\t},\r\n\t\tisDailyVisit: true\r\n\t})\r\n        useCaptcha(formClass.value)\r\n\t// let script = null\r\n\t// script = document.createElement('script')\r\n\t// script.src = 'https://o.alicdn.com/captcha-frontend/aliyunCaptcha/AliyunCaptcha.js'\r\n\t// script.type = 'text/javascript'\r\n\t// document.head.appendChild(script)\r\n\t// script.onload = () => {\r\n\t// \tinitAliyunCaptcha({\r\n\t// \t\tSceneId: useCheckMobile().getItem() ? '9v5glil4i' : '9sjme0s4n',\r\n\t// \t\tprefix: 'uqby6fg',\r\n\t// \t\tmode: 'popup',\r\n\t// \t\telement: '#captcha-element',\r\n\t// \t\tbutton: '#captcha-button',\r\n\t// \t\tcaptchaVerifyCallback: captchaVerifyCallback,\r\n\t// \t\tonBizResultCallback: onBizResultCallback,\r\n\t// \t\tgetInstance: getInstance,\r\n\t// \t\tslideStyle: {\r\n\t// \t\t\twidth: 360,\r\n\t// \t\t\theight: 40,\r\n\t// \t\t},\r\n\t// \t\tlanguage: 'en',\r\n\t// \t\timmediate: false,\r\n\t// \t\tregion: 'cn'\r\n\t// \t});\r\n\t// }\r\n        //\r\n\t// let scriptWebview = null\r\n\t// scriptWebview = document.createElement('script')\r\n\t// scriptWebview.src = '/uni.webview.1.5.1.js'\r\n\t// scriptWebview.type = 'text/javascript'\r\n\t// document.head.appendChild(scriptWebview)\r\n\t// function getInstance(val) {\r\n\t// \tcaptcha = val\r\n\t// }\r\n\t// async function captchaVerifyCallback(captchaVerifyParam) {\r\n\t// \tformClass.value.bindChildSendCode(captchaVerifyParam)\r\n\t// \tconst returnData = await formClass.value.returnData()\r\n\t// \treturn {\r\n\t// \t\tcaptchaResult: true, // 验证码验证是否通过，boolean类型，必选\r\n\t// \t\tbizResult: returnData.codeData.captcha, // 业务验证是否通过，boolean类型，可选，若为无业务验证结果的场景，bizResult可以为空\r\n\t// \t};\r\n\t// }\r\n\t// function onBizResultCallback(bizResult) { }\r\n})\r\n\r\n// onBeforeUnmount(() => {\r\n// \tdocument.getElementById('aliyunCaptcha-mask')?.remove();\r\n// \tdocument.getElementById('aliyunCaptcha-window-popup')?.remove();\r\n// })\r\nonUnmounted(() => {\r\n\tformClass.value.bindClearTimer()\r\n})\r\ndefineExpose({ historyUrl })\r\n</script>\r\n<script>\r\nimport { defineComponent } from \"vue\";\r\nexport default defineComponent({\r\n\tbeforeRouteEnter(to, from, next) {\r\n\t\tnext(function (vm) {\r\n\t\t\t// 判斷是不是直接從瀏覽器進入註冊頁\r\n\t\t\tvm.historyUrl = from.name\r\n\t\t});\r\n\t}\r\n});\r\n</script>\r\n<style scoped lang=\"scss\" src=\"@/pages/login/components/index.scss\"></style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAe,UAAA,KAAA,iBAAA,sBAAA;AC4Nf,MAAA,cAAe,gBAAgB;AAAA,EAC9B,iBAAiB,IAAI,MAAM,MAAM;AAChC,SAAK,SAAU,IAAI;AAElB,SAAG,aAAa,KAAK;AAAA,IAAA,CACrB;AAAA,EACF;AACD,CAAC;;;;;AApJgC,eAAW;AAMtC,UAAA,WAAW,IAAI,CAAC;AACtB,UAAM,QAAQ;AACL,aAAA,QAAQ,MAAM,MAAM,OAAO,OAAO,MAAM,MAAM,IAAI,IAAI;AACzD,UAAA,EAAE,MAAM;AAGd,QAAI,UAAU,CAAA;AACd,cAAU,SAAS,UAAU,IAAI,CAAC,SAAS,aAAa,YAAY,eAAe,IAAI,CAAC,SAAS,aAAa,YAAY,eAAe;AACzI,UAAM,YAAY,IAAI,IAAI,SAAS,OAAO,CAAC;AAC3C,UAAM,WAAW,IAAI,UAAU,MAAM,IAAI;AACzC,UAAM,aAAa;AAqCJ,UAAM,MAAM;AAoFd,aAAA,EAAE,YAAY;;;;;;;;;;;;;;;;;;;;;;"}