import{l as K,q as H,s as j,p as c,b as O,i as k,c as _,ad as S,n as T,G as N,a2 as B}from"./BqoG-WQz.js";import{bu as x,q as C,bv as I,aj as L,bw as m,bx as R,by as q,bz as w,bA as F,bB as E,bC as V,bD as z}from"./DTF1NCKZ.js";const D=K({props:{vnode:{type:Object,required:!0},route:{type:Object,required:!0},vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(e){const o=e.renderKey,a=e.route,r={};for(const n in e.route)Object.defineProperty(r,n,{get:()=>o===e.renderKey?e.route[n]:a[n],enumerable:!0});return H(x,j(r)),()=>c(e.vnode,{ref:e.vnodeRef})}}),W=K({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(e,{attrs:o,slots:a,expose:r}){const n=C(),i=O(),d=k(x,null);let l;r({pageRef:i});const s=k(I,null);let u;const g=n.deferHydration();if(n.isHydrating){const t=n.hooks.hookOnce("app:error",g);L().beforeEach(t)}return e.pageKey&&_(()=>e.pageKey,(t,v)=>{t!==v&&n.callHook("page:loading:start")}),()=>c(E,{name:e.name,route:e.route,...o},{default:t=>{const v=J(d,t.route,t.Component),h=d&&d.matched.length===t.route.matched.length;if(!t.Component){if(u&&!h)return u;g();return}if(u&&s&&!s.isCurrent(t.route))return u;if(v&&d&&(!s||s!=null&&s.isCurrent(d)))return h?u:null;const f=m(t,e.pageKey);!n.isHydrating&&!M(d,t.route,t.Component)&&l===f&&n.callHook("page:loading:end"),l=f;const y=!!(e.transition??t.route.meta.pageTransition??R),A=y&&G([e.transition,t.route.meta.pageTransition,R,{onAfterLeave:()=>{n.callHook("page:transition:finish",t.Component)}}].filter(Boolean)),b=e.keepalive??t.route.meta.keepalive??q;return u=w(B,y&&A,F(b,c(S,{suspensible:!0,onPending:()=>n.callHook("page:start",t.Component),onResolve:()=>{T(()=>n.callHook("page:finish",t.Component).then(()=>n.callHook("page:loading:end")).finally(g))}},{default:()=>{const p=c(D,{key:f||void 0,vnode:a.default?c(N,void 0,a.default(t)):t.Component,route:t.route,renderKey:f||void 0,trackRootNodes:y,vnodeRef:i});return b&&(p.type.name=t.Component.type.name||t.Component.type.__name||"RouteProvider"),p}}))).default(),u}})}});function G(e){const o=e.map(a=>({...a,onAfterLeave:a.onAfterLeave?V(a.onAfterLeave):void 0}));return z(...o)}function J(e,o,a){if(!e)return!1;const r=o.matched.findIndex(n=>{var i;return((i=n.components)==null?void 0:i.default)===(a==null?void 0:a.type)});return!r||r===-1?!1:o.matched.slice(0,r).some((n,i)=>{var d,l,s;return((d=n.components)==null?void 0:d.default)!==((s=(l=e.matched[i])==null?void 0:l.components)==null?void 0:s.default)})||a&&m({route:o,Component:a})!==m({route:e,Component:a})}function M(e,o,a){return e?o.matched.findIndex(n=>{var i;return((i=n.components)==null?void 0:i.default)===(a==null?void 0:a.type)})<o.matched.length-1:!1}export{W as _};
